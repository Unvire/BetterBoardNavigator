<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Better Board Navigator</title>
    <link rel="stylesheet" href="/static/css/style.css"/>
    <script src="https://cdn.jsdelivr.net/pyodide/v0.26.0/full/pyodide.js"></script>
    <script type="text/javascript" src="/static/js/configurePythonFunctions.js"></script>    
    <script type="text/javascript" src="/static/js/fileFunctions.js"></script>
</head>
<body>
    <div class="buttons-row-flexbox">
        <div class="buttons-flexbox">
            <input type="file" id="load-file-button" disabled="true">Load File</button>
            <button type="button" id="change-colors-button">Change Colors</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="change-side-button">Change Side</button>
            <button type="button" id="mirror-side-button">Mirror Side</button>
            <button type="button" id="toggle-outlines-button">Show/Hide Outlines</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="default-view-button">Default View</button>
            <button type="button" id="components-area-button">Area From Components</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="clicked-component-button">Toggle Clicked Component Name Mode</button>
            <button type="button" id="unselect-components-button">Clear component markers</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="toggle-net-marker-button">Hide net markers</button>
            <button type="button" id="unselect-net-button">Unselect net</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="prefix-components-button">Prefix components</button>
            <button type="button" id="unselect-prefix-button">Unselect prefix components</button>
        </div>
        <div class="buttons-flexbox">
            <button type="button" id="help-button">Help</button>
            <button type="button" id="about-button">About</button>
        </div>
    </div>
    <div class="grid-container">
        <div class="item-left-top">
            <p>current side</p>
        </div>
        <div class="item-left-middle">
            <p>components list</p>
        </div>
        <div class="item-left-bottom">
            <p>component pinout</p>
        </div>
        <div class="item-center">
            <canvas id="canvas"></canvas>
        </div>
        <div class="item-right-middle">
            <p>nets list</p>
        </div>
        <div class="item-right-bottom">
            <p>selected components</p>
        </div>
    </div>
    <script>
        var pyodide;
        var loadedFileName = "";
        const canvas = document.getElementById('canvas');
        const loadFileButton = document.getElementById('load-file-button')

        document.addEventListener("DOMContentLoaded", async () => {
            pyodide = await loadPyodide();
            configurePythonPath(pyodide);                      
            loadPygame(pyodide);            
            await loadLocalModules(pyodide);
            loadFileButton.disabled = false;
        });

        loadFileButton.addEventListener("change", async (event) => {
            const file = event.target.files[0];
            if (file) {
                await removePreviousFileFromFS(pyodide, loadedFileName);
                await openAndLoadCadFile(pyodide, file);
                loadedFileName = file.name;
            }
        });

    </script>
</body>
</html>